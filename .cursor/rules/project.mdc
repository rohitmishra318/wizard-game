---
description: 
globs: 
alwaysApply: true
---
# ğŸ”® MYSTIC REALM DEFENDER - Project Documentation

## ğŸ“‹ Project Overview

**Mystic Realm Defender** is a 2D magical survival game where players control a powerful wizard defending against infinite waves of mythological creatures. Originally developed during the first Vibe Gaming Hackathon in LATAM, the game has been transformed from a zombie apocalypse theme to an immersive fantasy magical realm.

### ğŸ¯ Core Concept
- **Genre**: 2D Top-down Magical Survival Shooter
- **Theme**: Fantasy/Magic with pixel art aesthetics
- **Gameplay**: Infinite waves with progressive difficulty scaling
- **Art Style**: Pixel art with magical effects and purple/blue color scheme

## ğŸ—ï¸ Technical Architecture

### ğŸ® Game Engine
- **Custom 2D Engine** built with HTML5 Canvas
- **Component-based architecture** with React hooks
- **60 FPS optimized rendering** with requestAnimationFrame
- **Pixel-perfect collision detection** using AABB algorithms
- **Sprite animation system** for wizards, creatures, and mages

### ğŸ”§ Technology Stack

#### Frontend
- **Next.js 15** - React framework with App Router
- **TypeScript** - Static typing for robust development
- **Tailwind CSS** - Utility-first styling with magical theme
- **HTML5 Canvas** - 2D game rendering and effects

#### Backend & Database
- **Supabase** - Real-time PostgreSQL database
- **Row Level Security (RLS)** - Data protection
- **Edge Functions** - Serverless game logic

#### Development Tools
- **Bun** - Fast runtime and package manager
- **ESLint** - Code quality enforcement
- **Cursor AI** - AI-assisted development

## ğŸ¨ Game Design

### ğŸ§™â€â™‚ï¸ Player Character
- **Wizard/Mage** - Magical spellcaster protagonist
- **Mana System** - Resource management instead of health
- **Spell Casting** - Projectile-based magic attacks
- **Movement** - WASD/Arrow key controls with sprite animations

### ğŸ‰ Enemies
- **Normal Creatures** - Basic mythological beings
- **Caster Creatures** - Magical enemies that cast spells
- **Progressive Scaling** - Health, speed, and abilities increase per wave
- **Exponential Difficulty** - Every 10 waves apply multipliers

### ğŸª„ Magic System
- **Spell Levels** (0-5): Progressive power increases
- **Multi-casting**: 1-4 simultaneous spells
- **Spell Effects**: Size scaling, spread patterns, cast rate
- **Mana Management**: Resource-based casting system

### ğŸ’ Economy
- **Crystals** - Primary currency earned from defeating creatures
- **Marketplace** - Upgrade system between waves
- **Spell Upgrades** - Damage, count, size, speed improvements
- **Mana Upgrades** - Maximum mana and regeneration

## ğŸ“ Project Structure

```
ğŸ“¦ mystic-realm-defender/
â”œâ”€â”€ ğŸ“ app/                     # Next.js App Router
â”‚   â”œâ”€â”€ ğŸ“ game/               # Game page route
â”‚   â”œâ”€â”€ ğŸ“ credits/            # Credits page
â”‚   â”œâ”€â”€ layout.tsx             # Root layout
â”‚   â”œâ”€â”€ page.tsx               # Home page
â”‚   â””â”€â”€ sitemap.ts             # SEO sitemap
â”œâ”€â”€ ğŸ“ components/             # React Components
â”‚   â”œâ”€â”€ GameScreen.tsx         # Main game container
â”‚   â”œâ”€â”€ GameCanvas.tsx         # Canvas rendering component
â”‚   â”œâ”€â”€ GameUI.tsx             # Game interface
â”‚   â”œâ”€â”€ Marketplace.tsx        # Upgrade shop
â”‚   â”œâ”€â”€ Leaderboard.tsx        # Score system
â”‚   â”œâ”€â”€ HomeScreen.tsx         # Main menu
â”‚   â”œâ”€â”€ LoadingScreen.tsx      # Asset loading
â”‚   â”œâ”€â”€ CoinParticles.tsx      # Crystal effects
â”‚   â””â”€â”€ FloatingParticles.tsx  # Background effects
â”œâ”€â”€ ğŸ“ hooks/                  # Custom React Hooks
â”‚   â”œâ”€â”€ useGameController.ts   # Main game orchestration
â”‚   â”œâ”€â”€ useGameState.ts        # Game state management
â”‚   â”œâ”€â”€ useAssetLoader.ts      # Sprite and texture loading
â”‚   â”œâ”€â”€ useInputHandlers.ts    # Keyboard/mouse input
â”‚   â”œâ”€â”€ useGameAudio.ts        # Sound effects system
â”‚   â”œâ”€â”€ useLeaderboard.ts      # Score persistence
â”‚   â””â”€â”€ useGameScreens.ts      # Screen state management
â”œâ”€â”€ ğŸ“ game/                   # Core Game Logic
â”‚   â”œâ”€â”€ Player.ts              # Wizard character system
â”‚   â”œâ”€â”€ Creatures.ts           # Enemy behavior and AI
â”‚   â”œâ”€â”€ Projectiles.ts         # Spell projectile physics
â”‚   â”œâ”€â”€ Collisions.ts          # Collision detection
â”‚   â””â”€â”€ Renderer.ts            # Canvas rendering engine
â”œâ”€â”€ ğŸ“ utils/                  # Utility Functions
â”‚   â”œâ”€â”€ math.ts                # Vector math and collision
â”‚   â”œâ”€â”€ marketplace.ts         # Upgrade calculations
â”‚   â””â”€â”€ coinParticles.ts       # Crystal particle effects
â”œâ”€â”€ ğŸ“ types/                  # TypeScript Definitions
â”‚   â””â”€â”€ game.ts                # Game entity interfaces
â”œâ”€â”€ ğŸ“ constants/              # Game Configuration
â”‚   â””â”€â”€ game.ts                # Balancing and settings
â”œâ”€â”€ ğŸ“ data/                   # Static Game Data
â”‚   â””â”€â”€ obstacles.ts           # Map obstacle definitions
â”œâ”€â”€ ğŸ“ lib/                    # External Integrations
â”‚   â”œâ”€â”€ supabase.ts            # Database client
â”‚   â””â”€â”€ metadata.ts            # SEO metadata
â”œâ”€â”€ ğŸ“ public/                 # Static Assets
â”‚   â”œâ”€â”€ ğŸ“ wizard/             # Player character sprites
â”‚   â”œâ”€â”€ ğŸ“ creature/           # Normal enemy sprites
â”‚   â”œâ”€â”€ ğŸ“ mage/               # Caster enemy sprites
â”‚   â”œâ”€â”€ floor-texture.png      # Game background
â”‚   â””â”€â”€ favicon.ico            # Site icon
â””â”€â”€ ğŸ“ sql/                    # Database Scripts
    â””â”€â”€ create_tables.sql      # Supabase setup
```

## ğŸ® Game Systems

### ğŸ”„ Game Loop
1. **Input Processing** - Handle keyboard/mouse events
2. **State Updates** - Update player, creatures, projectiles
3. **Collision Detection** - Check spell hits and creature contact
4. **Rendering** - Draw all game entities to canvas
5. **UI Updates** - Refresh mana, score, wave information

### ğŸŒŠ Wave System
- **Infinite Progression** - No maximum wave limit
- **Creature Spawning** - Progressive increase in enemy count
- **Difficulty Scaling** - Health, speed, and abilities grow
- **Marketplace Breaks** - Upgrade opportunities between waves
- **Exponential Scaling** - Major boosts every 10 waves

### ğŸ¯ Combat System
- **Spell Casting** - Spacebar to cast in movement direction
- **Projectile Physics** - Velocity-based movement with collision
- **Damage Calculation** - Spell damage vs creature health
- **Knockback Effects** - Creatures pushed by spell impacts
- **Invulnerability Frames** - Temporary damage immunity

### ğŸ’¾ Persistence System
- **Leaderboard** - Top scores with Supabase
- **Game Statistics** - Total games played tracking
- **Audio Settings** - Volume preferences in localStorage
- **Real-time Updates** - Live score synchronization

## ğŸ¨ Visual Design

### ğŸ¨ Color Palette
- **Primary**: Purple (#8A2BE2) - Magical theme
- **Secondary**: Blue (#4A90E2) - Mana and spells
- **Accent**: Gold (#FFD700) - Crystals and rewards
- **Background**: Dark gradients with magical effects

### ğŸ–¼ï¸ Sprite System
- **Directional Animation** - N/S/E/W facing sprites
- **Walking Cycles** - Left/Right foot animation frames
- **Standing Poses** - Idle animations for all directions
- **Consistent Style** - Pixel art aesthetic throughout

### âœ¨ Visual Effects
- **Particle Systems** - Crystal collection effects
- **Spell Trails** - Projectile visual feedback
- **Screen Shake** - Impact feedback
- **Gradient Backgrounds** - Atmospheric depth
- **Floating Particles** - Ambient magical atmosphere

## ğŸ”§ Development Guidelines

### ğŸ“ Code Standards
- **TypeScript** - Strict typing for all components
- **Functional Components** - React hooks pattern
- **Custom Hooks** - Separation of concerns
- **Immutable State** - Predictable state management
- **Error Boundaries** - Graceful error handling

### ğŸ¯ Performance Optimization
- **Object Pooling** - Reuse projectile instances
- **Efficient Rendering** - Only draw visible entities
- **Memory Management** - Clean up unused resources
- **60 FPS Target** - Consistent frame rate
- **Asset Preloading** - Smooth gameplay experience

## ğŸš€ Deployment

### ğŸŒ Production Environment
- **Vercel** - Automatic deployment from Git
- **Edge Functions** - Global performance
- **Analytics** - Performance monitoring
- **Custom Domain** - mystic.decker.sh


## ğŸ¤ Contributing

### ğŸ“‹ Development Setup
1. Clone repository
2. Install dependencies with `bun install`
3. Set up Supabase environment variables
4. Run development server with `bun dev`
5. Access game at `http://localhost:3001`

### ğŸ”„ Workflow
1. Create feature branch
2. Implement changes with TypeScript
3. Test gameplay balance
4. Submit pull request
5. Code review and merge

## ğŸ“š Resources

### ğŸ® Game Design
- **Balancing Constants** - `/constants/game.ts`
- **Entity Definitions** - `/types/game.ts`
- **Sprite Guidelines** - Pixel art standards
- **Audio Standards** - Sound effect specifications

### ğŸ”§ Technical Documentation
- **API Reference** - Hook and component docs
- **Database Schema** - Supabase table structure
- **Deployment Guide** - Production setup
- **Performance Guide** - Optimization techniques

---

**Made with ğŸ”® magic and â¤ï¸ by the Vibe Gaming team**

*"Defend the mystical realm with the power of code and creativity"*
